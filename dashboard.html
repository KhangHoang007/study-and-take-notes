<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Study Notes - Dashboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: url('./background_pc.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #333;
    }
    header {
      background: rgba(255,255,255,0.9);
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .left-buttons button, .right-info {
      margin: 5px;
    }
    .container {
      padding: 20px;
    }
    textarea, input[type="text"], input[type="time"], input[type="date"] {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      padding: 10px;
      border: none;
      border-radius: 8px;
      background-color: #ff69b4;
      color: white;
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
    }
    .flex {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
  <audio autoplay loop>
    <source src="https://files.catbox.moe/kqtizv.mp3" type="audio/mpeg">
  </audio>

  <header>
    <div class="left-buttons">
      <strong id="username">Xin ch√†o!</strong>
      <button onclick="confirmLogout()">ƒêƒÉng xu·∫•t</button>
      <button onclick="confirmDelete()">Xo√° t√†i kho·∫£n</button>
    </div>
    <div class="right-info">
      <span id="vnTime"></span>
    </div>
  </header>

  <div class="container">
    <h2>M·ª•c ti√™u h√¥m nay</h2>
    <textarea id="goalInput" placeholder="Vi·∫øt m·ª•c ti√™u c·ªßa b·∫°n..."></textarea>
    <input type="date" id="goalDate" />
    <input type="time" id="goalTime" />
    <button onclick="saveGoal()">L∆∞u m·ª•c ti√™u</button>
    <button onclick="clearGoalHistory()">üóëÔ∏è Xo√° l·ªãch s·ª≠ m·ª•c ti√™u</button>

    <h3>L·ªãch s·ª≠ m·ª•c ti√™u</h3>
    <table id="goalHistory">
      <tr><th>Th·ªùi gian</th><th>M·ª•c ti√™u</th></tr>
    </table>

    <h3>Ghi ch√∫ n·ªïi b·∫≠t trong tu·∫ßn</h3>
    <table>
      <tr><th>Th·ª©</th><th>Ghi ch√∫</th></tr>
      <tr><td>Th·ª© 2</td><td><input type="text"></td></tr>
      <tr><td>Th·ª© 3</td><td><input type="text"></td></tr>
      <tr><td>Th·ª© 4</td><td><input type="text"></td></tr>
      <tr><td>Th·ª© 5</td><td><input type="text"></td></tr>
      <tr><td>Th·ª© 6</td><td><input type="text"></td></tr>
      <tr><td>Th·ª© 7</td><td><input type="text"></td></tr>
      <tr><td>Ch·ªß Nh·∫≠t</td><td><input type="text"></td></tr>
    </table>

    <div style="margin-top: 30px; text-align: center">
      <button onclick="window.location.href='flashcard.html'">H·ªçc c√πng Flashcard ‚û§</button>
    </div>
  </div>

  <script>
    const user = JSON.parse(localStorage.getItem('user'));
    document.getElementById('username').textContent = `Ch√†o m·ª´ng, ${user?.username || 'b·∫°n'}!`;

    function updateVietnamTime() {
      const now = new Date();
      const vnNow = now.toLocaleString("vi-VN", {
        timeZone: "Asia/Ho_Chi_Minh",
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
        hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
      document.getElementById('vnTime').textContent = vnNow;
    }
    setInterval(updateVietnamTime, 1000);
    updateVietnamTime();

    function confirmLogout() {
      if (confirm('B·∫°n c√≥ ch·∫Øc l√† mu·ªën ƒëƒÉng xu·∫•t ra ngo√†i kh√¥ng?')) {
        alert('ƒêƒÉng xu·∫•t th√†nh c√¥ng!');
        window.location.href = 'index.html';
      }
    }

    function confirmDelete() {
      if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° t√†i kho·∫£n n√†y?')) {
        localStorage.removeItem('user');
        alert('T√†i kho·∫£n ƒë√£ b·ªã xo√°!');
        window.location.href = 'index.html';
      }
    }

    function saveGoal() {
      const text = document.getElementById('goalInput').value;
      const date = document.getElementById('goalDate').value;
      const time = document.getElementById('goalTime').value;
      const vnNow = new Date().toLocaleString("vi-VN", {
        timeZone: "Asia/Ho_Chi_Minh",
        hour: '2-digit', minute: '2-digit', second: '2-digit', 
        weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
      });

      const table = document.getElementById('goalHistory');
      const row = table.insertRow(-1);
      row.insertCell(0).innerText = vnNow;
      row.insertCell(1).innerText = text;

      if (Notification.permission !== "granted") {
        Notification.requestPermission();
      }

      if (date && time) {
        const target = new Date(`${date}T${time}:00`);
        const delay = target.getTime() - Date.now();
        if (delay > 0) {
          setTimeout(() => {
            new Notification("‚è∞ ƒê√£ t·ªõi h·∫°n ho√†n th√†nh m·ª•c ti√™u!");
          }, delay);
        }
      }
    }

    function clearGoalHistory() {
      const table = document.getElementById('goalHistory');
      while (table.rows.length > 1) {
        table.deleteRow(1);
      }
    }
  </script>
</body>
</html>